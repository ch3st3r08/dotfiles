- name: "OS | Installing essential packages"
  community.general.pacman:
    name:
      - curl
      - tree
      - archlinux-contrib
      - pacman-contrib
      - xdg-utils
      - stow
      - xdg-user-dirs
      - unzip
      - libva-mesa-driver
      - intel-media-driver
      - sound-theme-freedesktop
      - xf86-video-amdgpu

- name: "OS | Installing networking packages and services"
  block:
    - name: Installing networking packages
      community.general.pacman:
        name:
          - iwd
          - networkmanager
          - network-manager-applet
 
    - name: Starting and enabling networkmanager service
      ansible.builtin.systemd_service:
        name: NetworkManager.service
        enabled: true
        state: started

- name: "OS | Installing audio packages"
  block:
    - name: "Installing packages"
      community.general.pacman:
        name:
          - pavucontrol
          - pipewire
          - pipewire-audio
          - pipewire-pulse
          - wireplumber
          - gst-plugin-pipewire

    - name: "Enable and Start Pipewire systemd user unit"
      ansible.builtin.systemd_service:
        name: pipewire.service
        enabled: true
        state: started
        scope: user

- name: "Install Paru AUR manager"
  import_tasks: paru.yml
